/***********************************************************************
 *  $RCSfile$
 *
 *  Copyright (C) 2004 Novell, Inc.
 *
 *  This program is free software; you can redistribute it and/or
 *  modify it under the terms of the GNU General Public
 *  License as published by the Free Software Foundation; either
 *  version 2 of the License, or (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *  General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public
 *  License along with this program; if not, write to the Free
 *  Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 *
 *  Author: Calvin Gaisford <cgaisford@novell.com>
 *
 ***********************************************************************/
using System;

using Gtk;
using Gdk;
using Gnome;
using Mono.Posix;

namespace Novell.iFolder
{
	public class Util
	{
		internal static string prefix = "@prefix@";
		internal static string imagesdir = "@prefix@/share/ifolder3/images";
		internal static string helpdir = "@prefix@/share/ifolder3/help";
		internal static int SectionSpacing = 20;
		internal static int SectionTitleSpacing = 5;
		internal static uint DefaultBorderWidth = 10;

		public static void InitCatalog()
		{
			Mono.Posix.Catalog.Init("@PACKAGE@", "@prefix@/share/locale");
		}


		public static string GS(string msgid)
		{
			return Mono.Posix.Catalog.GetString(msgid);
		}


		public static string ImagesPath(string imgStr)
		{
			return string.Format("{0}/{1}", imagesdir, imgStr);
		}

		public static string HelpURL(string helpFile)
		{
			return string.Format("file://{0}/en/doc/user/data/{1}", helpdir, helpFile);
		}

		public static void OpenInBrowser(string path)
		{
			System.Diagnostics.Process process;
			process = new System.Diagnostics.Process();
			process.StartInfo.CreateNoWindow = true;
			process.StartInfo.UseShellExecute = false;
			process.StartInfo.FileName = "nautilus";
			process.StartInfo.Arguments = "\"" + path + "\"";

			try
			{
				process.Start();
				return;
			}
			catch(Exception e)
			{
			}

			process.StartInfo.FileName = "konqueror";

			try
			{
				process.Start();
				return;
			}
			catch(Exception e)
			{
			}

			throw new Exception("Unable to launch file browser");
		}

		public static void ShowHelp(string helpFile, Gtk.Window parent)
		{
			try
			{
				Gnome.Url.Show(HelpURL(helpFile));
			}
			catch(Exception e)
			{
				MessageDialog med = new MessageDialog(parent,
					DialogFlags.DestroyWithParent | DialogFlags.Modal,
					MessageType.Error,
					ButtonsType.Close,
					string.Format("Error displaying help file:{0}", e));
				med.Title = "Help file error";
				med.Run();
				med.Hide();
			}
		}

		public static void ShowAbout()
		{
			try
			{
				// Replace this with the logo graphic when we get it
				//Pixbuf logo = new Pixbuf(ImagesPath("ifolder24.png"));
				string[] authors = new string[]
				{
					"Jared Allen <jpallen@novell.com>",
					"Brady Anderson <banderso@novell.com>",
					"James Bell",
					"Doug Eddy",
					"Calvin Gaisford <cgaisford@novell.com>",
					"Bruce Getter",
					"Mike Lasky",
					"Rob Lyon",
					"Dale Olds",
					"Sharon Smith",
					"Joe Stark",
					"Paul Thomas",
					"Russ Young",
				};

				About about = new About("iFolder", "0.10",
										"Copyright (C) 2004 Novell, Inc.",
										"The iFolder Project is a file sharing solution for workgroup environments. The project is built on the mono/.Net framework to integrate seamlessly into existing desktop environments.",
										authors,
										null,
										null,
										new Gdk.Pixbuf(Util.ImagesPath(
											"ifolder-about.png")));
				about.Show();
			}
			catch(Exception e)
			{
			}
		}
	}
}
